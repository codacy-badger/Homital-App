(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{"1d1f":function(e,n,t){"use strict";var r=t("9ed2"),a=t.n(r);a.a},3285:function(e,n,t){"use strict";t.r(n);var r=t("6263"),a=t.n(r);for(var s in r)"default"!==s&&function(e){t.d(n,e,(function(){return r[e]}))}(s);n["default"]=a.a},"60e9":function(e,n,t){"use strict";var r;t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return s})),t.d(n,"a",(function(){return r}));var a=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("v-uni-view",[t("v-uni-view",{staticClass:"uni-padding-wrap uni-common-mt"},[t("v-uni-view",{staticClass:"uni-hello-text"},[e._v("Please log in.")]),t("v-uni-view",{staticClass:"inputArea"},[t("v-uni-input",{staticClass:"inputClass",attrs:{placeholder:"Please enter your username/email"},model:{value:e.username,callback:function(n){e.username=n},expression:"username"}})],1),t("v-uni-view",{staticClass:"inputArea"},[t("v-uni-input",{staticClass:"inputClass",attrs:{placeholder:"Please enter your password",type:"password"},model:{value:e.password,callback:function(n){e.password=n},expression:"password"}})],1),t("v-uni-view",{staticClass:"uni-btn-v uni-common-mt"},[t("v-uni-button",{attrs:{type:"primary",loading:e.loggingInProcessing},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e._login.apply(void 0,arguments)}}},[e._v(e._s(0==e.loggingInProcessing?"log in":"logging in in progress"))]),t("v-uni-button",{attrs:{type:"primary"},on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e._register.apply(void 0,arguments)}}},[e._v("Or register here")])],1)],1)],1)},s=[]},6263:function(e,n,t){"use strict";var r=t("4ea4");t("caad"),t("2532"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,t("96cf");var a=r(t("1da1")),s={data:function(){return{username:"",password:"",success:"",valid:!1,error:"",refresh_token:"",loggingInProcessing:!1}},methods:{_register:function(){uni.navigateTo({url:"../login/register",success:function(e){},fail:function(){},complete:function(){}})},_login:function(){var e=this;return(0,a.default)(regeneratorRuntime.mark((function n(){var t,r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t=e,!(e.username.length<=0)){n.next=6;break}return uni.showToast({title:"Cannot lah please enter valid username",duration:2e3}),n.abrupt("return");case 6:if(!(e.password.length<=0)){n.next=11;break}return uni.showToast({title:"forgot ur password meh",duration:2e3}),n.abrupt("return");case 11:return t.loggingInProcessing=!0,r=e.username.includes("@")?"email":"username",s=getApp().globalData.base_url+"/auth/user/login?by="+r,n.next=16,uni.request({url:s,data:{email:t.username,username:t.username,password:t.password},method:"POST",header:{"content-type":"application/json"},success:function(){var e=(0,a.default)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("this.email"+t.email),console.log("this.username"+t.username),!n.data.success){e.next=15;break}return t.valid=!0,t.refresh_token=n.data.refresh_token,uni.setStorageSync("refresh_token",t.refresh_token),uni.setStorageSync("userinfo",t.username),uni.setStorageSync("notloggedin",!1),console.log("login success set, notloggedin =",uni.getStorageSync("notloggedin")),e.next=11,uni.showToast({title:"log in successfully",duration:2e3});case 11:t.loggingInProcessing=!1,uni.navigateBack(),e.next=18;break;case 15:t.valid=!1,t.error=n.data.error,uni.showToast({title:t.error,duration:2e3});case 18:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}(),fail:function(){var n=(0,a.default)(regeneratorRuntime.mark((function n(r){var s,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(e.username.length<=0)){n.next=5;break}return uni.showToast({title:"Cannot lah please enter valid username",duration:2e3}),n.abrupt("return");case 5:if(!(e.password.length<=0)){n.next=10;break}return uni.showToast({title:"forgot ur password meh",duration:2e3}),n.abrupt("return");case 10:return s=e.username.includes("@")?"email":"username",i=getApp().globalData.base_url+"/auth/user/login?by="+s,n.next=14,uni.request({url:i,data:{email:t.username,username:t.username,password:t.password},method:"POST",header:{"content-type":"application/json"},success:function(){var e=(0,a.default)(regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(t.email),!n.data.success){e.next=13;break}return t.valid=!0,t.refresh_token=n.data.refresh_token,uni.setStorageSync("refresh_token",t.refresh_token),uni.setStorageSync("userinfo",t.username),uni.setStorageSync("notloggedin",!1),console.log("login success set, notloggedin =",uni.getStorageSync("notloggedin")),e.next=10,uni.showToast({title:"log in successfully",duration:2e3});case 10:uni.navigateBack(),e.next=16;break;case 13:t.valid=!1,t.error=n.data.error,uni.showToast({title:t.error,duration:2e3});case 16:case"end":return e.stop()}}),e)})));function n(n){return e.apply(this,arguments)}return n}()});case 14:case"end":return n.stop()}}),n)})));function r(e){return n.apply(this,arguments)}return r}()});case 16:case"end":return n.stop()}}),n)})))()}}};n.default=s},"9ed2":function(e,n,t){var r=t("dfcb");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var a=t("4f06").default;a("8160ec12",r,!0,{sourceMap:!1,shadowMode:!1})},a86a:function(e,n,t){"use strict";t.r(n);var r=t("60e9"),a=t("3285");for(var s in a)"default"!==s&&function(e){t.d(n,e,(function(){return a[e]}))}(s);t("1d1f");var i,o=t("f0c5"),u=Object(o["a"])(a["default"],r["b"],r["c"],!1,null,"46941bf7",null,!1,r["a"],i);n["default"]=u.exports},dfcb:function(e,n,t){var r=t("24fb");n=r(!1),n.push([e.i,".container[data-v-46941bf7]{padding:20px;font-size:14px;line-height:24px}.inputArea[data-v-46941bf7]{padding:%?20?% 10%;border:1px solid #7fffd4;border-radius:%?5?%;margin:%?5?%}",""]),e.exports=n}}]);