(function(e){function n(n){for(var o,i,s=n[0],u=n[1],c=n[2],l=0,p=[];l<s.length;l++)i=s[l],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(e[o]=u[o]);g&&g(n);while(p.length)p.shift()();return a.push.apply(a,c||[]),t()}function t(){for(var e,n=0;n<a.length;n++){for(var t=a[n],o=!0,i=1;i<t.length;i++){var u=t[i];0!==r[u]&&(o=!1)}o&&(a.splice(n--,1),e=s(s.s=t[0]))}return e}var o={},r={index:0},a=[];function i(e){return s.p+"static/js/"+({"pages-index-index":"pages-index-index","pages-login-login":"pages-login-login","pages-login-register":"pages-login-register","pages-login-userAgreement":"pages-login-userAgreement","pages-me-me":"pages-me-me"}[e]||e)+"."+{"pages-index-index":"25c792d8","pages-login-login":"f4d3ba10","pages-login-register":"d5d8b1ff","pages-login-userAgreement":"f388ac68","pages-me-me":"63f58962"}[e]+".js"}function s(n){if(o[n])return o[n].exports;var t=o[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.e=function(e){var n=[],t=r[e];if(0!==t)if(t)n.push(t[2]);else{var o=new Promise((function(n,o){t=r[e]=[n,o]}));n.push(t[2]=o);var a,u=document.createElement("script");u.charset="utf-8",u.timeout=120,s.nc&&u.setAttribute("nonce",s.nc),u.src=i(e);var c=new Error;a=function(n){u.onerror=u.onload=null,clearTimeout(l);var t=r[e];if(0!==t){if(t){var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;c.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",c.name="ChunkLoadError",c.type=o,c.request=a,t[1](c)}r[e]=void 0}};var l=setTimeout((function(){a({type:"timeout",target:u})}),12e4);u.onerror=u.onload=a,document.head.appendChild(u)}return Promise.all(n)},s.m=e,s.c=o,s.d=function(e,n,t){s.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,n){if(1&n&&(e=s(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)s.d(t,o,function(n){return e[n]}.bind(null,o));return t},s.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(n,"a",n),n},s.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},s.p="/",s.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],c=u.push.bind(u);u.push=n,u=u.slice();for(var l=0;l<u.length;l++)n(u[l]);var g=c;a.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"034f":function(e,n,t){"use strict";var o=t("ef9e"),r=t.n(o);r.a},"23be":function(e,n,t){"use strict";t.r(n);var o=t("3b4e"),r=t.n(o);for(var a in o)"default"!==a&&function(e){t.d(n,e,(function(){return o[e]}))}(a);n["default"]=r.a},"3b4e":function(e,n,t){"use strict";var o=t("4ea4");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,t("96cf");var r=o(t("1da1")),a=t("eb11"),i={globalData:{base_url:"https://homital.ml:2333/api",access_token:""},onLaunch:function(){var e=(0,r.default)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("App Launch"),e.next=3,a.functions.requestAcessToken((function(e){console.log("rat: callback, succ=",e),e?uni.setStorageSync("notloggedin",!1):(uni.setStorageSync("notloggedin",!0),uni.removeStorageSync("refresh_token"),uni.removeStorageSync("userinfo"))}));case 3:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}(),onShow:function(){console.log("App Show")},onHide:function(){console.log("App Hide")}};n.default=i},"3dfd":function(e,n,t){"use strict";t.r(n);var o=t("64f9"),r=t("23be");for(var a in r)"default"!==a&&function(e){t.d(n,e,(function(){return r[e]}))}(a);t("034f");var i,s=t("f0c5"),u=Object(s["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],i);n["default"]=u.exports},"56d7":function(e,n,t){"use strict";var o=t("4ea4"),r=o(t("5530"));t("e260"),t("e6cf"),t("cca6"),t("a79d"),t("6cdc"),t("1c31"),t("921b");var a=o(t("e143")),i=o(t("3dfd"));a.default.config.productionTip=!1,i.default.mpType="app";var s=new a.default((0,r.default)({},i.default));s.$mount()},5768:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o={pages:{"pages/index/index":{navigationBarTitleText:"Homital Lamp",enablePullDownRefresh:!0},"pages/login/register":{navigationBarTitleText:"Register @ Homital:>"},"pages/login/userAgreement":{navigationBarTitleText:"Homital User Agreement"},"pages/login/login":{navigationBarTitleText:"Log in to Homital"},"pages/me/me":{navigationBarTitleText:"Me",enablePullDownRefresh:!0}},globalStyle:{navigationBarTextStyle:"black",navigationBarTitleText:"uni-app",navigationBarBackgroundColor:"#F8F8F8",backgroundColor:"#F8F8F8"}};n.default=o},"64f9":function(e,n,t){"use strict";var o;t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return o}));var r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("App",{attrs:{keepAliveInclude:e.keepAliveInclude}})},a=[]},"6cdc":function(e,n,t){"use strict";(function(e){var n=t("4ea4"),o=n(t("e143"));e["____EAAAB13____"]=!0,delete e["____EAAAB13____"],e.__uniConfig={globalStyle:{navigationBarTextStyle:"black",navigationBarTitleText:"uni-app",navigationBarBackgroundColor:"#F8F8F8",backgroundColor:"#F8F8F8"},tabBar:{color:"#7A7E83",selectedColor:"#007AFF",borderStyle:"black",backgroundColor:"#F8F8F8",list:[{pagePath:"pages/index/index",text:"Control",iconPath:"",selectedIconPath:"",redDot:!1,badge:""},{pagePath:"pages/me/me",text:"Me",iconPath:"",selectedIconPath:"",redDot:!1,badge:""}]}},e.__uniConfig.router={mode:"hash",base:"/"},e.__uniConfig.publicPath="/",e.__uniConfig["async"]={loading:"AsyncLoading",error:"AsyncError",delay:200,timeout:6e4},e.__uniConfig.debug=!1,e.__uniConfig.networkTimeout={request:6e4,connectSocket:6e4,uploadFile:6e4,downloadFile:6e4},e.__uniConfig.sdkConfigs={},e.__uniConfig.qqMapKey="XVXBZ-NDMC4-JOGUS-XGIEE-QVHDZ-AMFV2",e.__uniConfig.nvue={"flex-direction":"column"},o.default.component("pages-index-index",(function(e){var n={component:t.e("pages-index-index").then(function(){return e(t("f75a"))}.bind(null,t)).catch(t.oe),delay:__uniConfig["async"].delay,timeout:__uniConfig["async"].timeout};return __uniConfig["async"]["loading"]&&(n.loading={name:"SystemAsyncLoading",render:function(e){return e(__uniConfig["async"]["loading"])}}),__uniConfig["async"]["error"]&&(n.error={name:"SystemAsyncError",render:function(e){return e(__uniConfig["async"]["error"])}}),n})),o.default.component("pages-login-register",(function(e){var n={component:t.e("pages-login-register").then(function(){return e(t("2816"))}.bind(null,t)).catch(t.oe),delay:__uniConfig["async"].delay,timeout:__uniConfig["async"].timeout};return __uniConfig["async"]["loading"]&&(n.loading={name:"SystemAsyncLoading",render:function(e){return e(__uniConfig["async"]["loading"])}}),__uniConfig["async"]["error"]&&(n.error={name:"SystemAsyncError",render:function(e){return e(__uniConfig["async"]["error"])}}),n})),o.default.component("pages-login-userAgreement",(function(e){var n={component:t.e("pages-login-userAgreement").then(function(){return e(t("2c6a"))}.bind(null,t)).catch(t.oe),delay:__uniConfig["async"].delay,timeout:__uniConfig["async"].timeout};return __uniConfig["async"]["loading"]&&(n.loading={name:"SystemAsyncLoading",render:function(e){return e(__uniConfig["async"]["loading"])}}),__uniConfig["async"]["error"]&&(n.error={name:"SystemAsyncError",render:function(e){return e(__uniConfig["async"]["error"])}}),n})),o.default.component("pages-login-login",(function(e){var n={component:t.e("pages-login-login").then(function(){return e(t("a86a"))}.bind(null,t)).catch(t.oe),delay:__uniConfig["async"].delay,timeout:__uniConfig["async"].timeout};return __uniConfig["async"]["loading"]&&(n.loading={name:"SystemAsyncLoading",render:function(e){return e(__uniConfig["async"]["loading"])}}),__uniConfig["async"]["error"]&&(n.error={name:"SystemAsyncError",render:function(e){return e(__uniConfig["async"]["error"])}}),n})),o.default.component("pages-me-me",(function(e){var n={component:t.e("pages-me-me").then(function(){return e(t("2f5c"))}.bind(null,t)).catch(t.oe),delay:__uniConfig["async"].delay,timeout:__uniConfig["async"].timeout};return __uniConfig["async"]["loading"]&&(n.loading={name:"SystemAsyncLoading",render:function(e){return e(__uniConfig["async"]["loading"])}}),__uniConfig["async"]["error"]&&(n.error={name:"SystemAsyncError",render:function(e){return e(__uniConfig["async"]["error"])}}),n})),e.__uniRoutes=[{path:"/",alias:"/pages/index/index",component:{render:function(e){return e("Page",{props:Object.assign({isQuit:!0,isEntry:!0,isTabBar:!0,tabBarIndex:0},__uniConfig.globalStyle,{navigationBarTitleText:"Homital Lamp",enablePullDownRefresh:!0})},[e("pages-index-index",{slot:"page"})])}},meta:{id:1,name:"pages-index-index",isNVue:!1,pagePath:"pages/index/index",isQuit:!0,isEntry:!0,isTabBar:!0,tabBarIndex:0,windowTop:44}},{path:"/pages/login/register",component:{render:function(e){return e("Page",{props:Object.assign({},__uniConfig.globalStyle,{navigationBarTitleText:"Register @ Homital:>"})},[e("pages-login-register",{slot:"page"})])}},meta:{name:"pages-login-register",isNVue:!1,pagePath:"pages/login/register",windowTop:44}},{path:"/pages/login/userAgreement",component:{render:function(e){return e("Page",{props:Object.assign({},__uniConfig.globalStyle,{navigationBarTitleText:"Homital User Agreement"})},[e("pages-login-userAgreement",{slot:"page"})])}},meta:{name:"pages-login-userAgreement",isNVue:!1,pagePath:"pages/login/userAgreement",windowTop:44}},{path:"/pages/login/login",component:{render:function(e){return e("Page",{props:Object.assign({},__uniConfig.globalStyle,{navigationBarTitleText:"Log in to Homital"})},[e("pages-login-login",{slot:"page"})])}},meta:{name:"pages-login-login",isNVue:!1,pagePath:"pages/login/login",windowTop:44}},{path:"/pages/me/me",component:{render:function(e){return e("Page",{props:Object.assign({isQuit:!0,isTabBar:!0,tabBarIndex:1},__uniConfig.globalStyle,{navigationBarTitleText:"Me",enablePullDownRefresh:!0})},[e("pages-me-me",{slot:"page"})])}},meta:{id:2,name:"pages-me-me",isNVue:!1,pagePath:"pages/me/me",isQuit:!0,isTabBar:!0,tabBarIndex:1,windowTop:44}},{path:"/preview-image",component:{render:function(e){return e("Page",{props:{navigationStyle:"custom"}},[e("system-preview-image",{slot:"page"})])}},meta:{name:"preview-image",pagePath:"/preview-image"}},{path:"/choose-location",component:{render:function(e){return e("Page",{props:{navigationStyle:"custom"}},[e("system-choose-location",{slot:"page"})])}},meta:{name:"choose-location",pagePath:"/choose-location"}},{path:"/open-location",component:{render:function(e){return e("Page",{props:{navigationStyle:"custom"}},[e("system-open-location",{slot:"page"})])}},meta:{name:"open-location",pagePath:"/open-location"}}]}).call(this,t("c8ba"))},ea0b:function(e,n,t){var o=t("24fb");n=o(!1),n.push([e.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/*每个页面公共css */",""]),e.exports=n},eb11:function(e,n,t){t("96cf");var o=t("c973");function r(e){a(e,1)}function a(e,n){return i.apply(this,arguments)}function i(){return i=o(regeneratorRuntime.mark((function e(n,t){var o,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o="",r=!1,e.next=4,uni.request({url:"https://homital.ml:2333/api/auth/user/token",data:{token:uni.getStorageSync("refresh_token")},method:"POST",header:{"content-type":"application/json"},success:function(e){if(e.data.success){console.log("reached1"),r=!0,o=e.data.accessToken,console.log("printing access token when first saved :"+o),getApp().globalData.accessToken=o;var t=getApp().globalData.accessToken;return console.log("printing again after saved : "+t),void n(!0)}return console.log("reached2"),console.log("res: ",e.data),o=e.data.error,void n(!1)},fail:function(e){console.log("failed to get access token in 1 attempt, let's try again"),t>0?a(n,t-1):n(!1)}});case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)}function s(e,n,t,o,r){return u.apply(this,arguments)}function u(){return u=o(regeneratorRuntime.mark((function e(n,t,a,i,u){var c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,getApp().globalData.accessToken;case 2:c=e.sent,console.log("printing access token before request: "+c),uni.request({url:t,data:a,method:i,header:{Authorization:"Bearer "+c},success:function(){var e=o(regeneratorRuntime.mark((function e(c){var l,g;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(l=c.data.success,console.log("request sent suc : "+l),!c.data.success){e.next=7;break}console.log("finally succeeded"),n(c.data),e.next=16;break;case 7:if(g=c.data.error,console.log("ur error is : "+g),!(u>0)){e.next=15;break}return console.log("ok access token was not ok, let's try again"),e.next=13,r(function(){var e=o(regeneratorRuntime.mark((function e(o){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!o){e.next=5;break}console.log("yayy access token gotten"),s(n,t,a,i,u-1),e.next=12;break;case 5:return e.next=7,uni.showToast({icon:"none",title:"Your token has already expired. Please log in again.",duration:2e3});case 7:uni.setStorageSync("notloggedin",!0),uni.removeStorageSync("refresh_token"),uni.removeStorageSync("userinfo"),n({success:!1,power:void 0}),console.log("ohno howw");case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 13:e.next=16;break;case 15:uni.showToast({icon:"none",title:"Your request cannot be processed",duration:2e3});case 16:case"end":return e.stop()}}),e)})));function c(n){return e.apply(this,arguments)}return c}(),fail:function(){var e=o(regeneratorRuntime.mark((function e(r){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("failed to get light status"),console.log("may have gotten empty response, let's retry"),e.next=4,getApp().globalData.accessToken;case 4:return s=e.sent,e.next=7,uni.request({url:t,data:a,method:i,header:{Authorization:"Bearer "+s},success:function(){var e=o(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=t.data.success,console.log("request sent suc : "+o),t.data.success?(console.log("finally succeeded"),n(t.data)):console.log("reached but res.data.success = false :(");case 3:case"end":return e.stop()}}),e)})));function t(n){return e.apply(this,arguments)}return t}(),fail:function(e){console.log("why second time still fail, hopeless alr")}});case 7:case"end":return e.stop()}}),e)})));function r(n){return e.apply(this,arguments)}return r}()});case 5:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}e.exports={functions:{requestAcessToken:r,makeAuthenticatedCall:s}}},ecd6:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o={appid:"__UNI__EAAAB13"};n.default=o},ef9e:function(e,n,t){var o=t("ea0b");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var r=t("4f06").default;r("a8651052",o,!0,{sourceMap:!1,shadowMode:!1})}});